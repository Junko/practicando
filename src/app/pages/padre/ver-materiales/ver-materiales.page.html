<app-header title="Ver materiales" [showBackButton]="true"></app-header>

<ion-content [fullscreen]="true" class="ver-materiales-content">
  
  <div *ngIf="loading" class="loading-container">
    <ion-spinner></ion-spinner>
    <p>Cargando información...</p>
  </div>

  <div *ngIf="!loading && estudiante" class="content-container">
    
    <!-- Título con nombre del estudiante -->
    <h1 class="lista-titulo">Lista de {{ estudiante.nombre }}</h1>

    <!-- Contenedor amarillo para las tarjetas -->
    <div class="materiales-container">
      
      <div class="material-accordion" *ngFor="let material of lista?.materiales; let i = index">
        
        <!-- Header del acordeón (siempre visible) -->
        <div class="accordion-header" (click)="toggleMaterial(material)">
          
          <div class="header-left">
            <h3 class="material-nombre">{{ material.nombre_material }}</h3>
          </div>
          
          <div class="header-right">
            <!-- Icono de flecha -->
            <ion-icon 
              [name]="material.isOpen ? 'chevron-up' : 'chevron-down'" 
              class="accordion-icon">
            </ion-icon>
            
            <!-- Checkbox circular -->
            <div class="status-indicator">
              <ion-checkbox 
                [(ngModel)]="material.entregado" 
                (ionChange)="onMaterialToggle(material)"
                (click)="$event.stopPropagation()">
              </ion-checkbox>
            </div>
          </div>
          
        </div>

        <!-- Contenido del acordeón (expande/colapsa) -->
        <div class="accordion-content" *ngIf="material.isOpen">
          
          <div class="material-body">
            
            <!-- Imagen del material -->
            <div class="material-imagen-small" *ngIf="material.imagen">
              <img [src]="material.imagen" [alt]="material.nombre_material">
            </div>

            <!-- Información del material -->
            <div class="material-info">
              
              <div class="material-descripcion" *ngIf="material.descripcion">
                <strong>Descripción:</strong> {{ material.descripcion }}
              </div>
              
              <div class="material-cantidad" *ngIf="material.cantidad">
                <strong>Cantidad:</strong> {{ material.cantidad }}
              </div>
              
            </div>

          </div>
          
        </div>

      </div>

      <!-- Mensaje si no hay materiales -->
      <div *ngIf="!lista || !lista.materiales || lista.materiales.length === 0" class="empty-state">
        <ion-icon name="document-text-outline" size="large" color="medium"></ion-icon>
        <h3>No hay materiales disponibles</h3>
        <p>No se ha asignado una lista de útiles para este grado y nivel</p>
      </div>

    </div>

  </div>

</ion-content>

<!-- Componente de tabs personalizado para padre -->
<app-custom-tabs [config]="tabsConfig"></app-custom-tabs>
